<script type="text/html" data-template-name="tuya-device">
  <div class="form-row">
    <ul id="node-input-tuya-tabs"></ul>
  </div>
  <div id="node-input-tabs-content">
    <div id="tuya-settings-tab" style="display:none">
      <div class="form-row">
        <label for="node-input-device"><i class="fa fa-dot-circle-o"></i> Device</label>
        <input type="text" id="node-input-device">
        <datalist id="list-avail-devices"></datalist>
      </div>
      <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
      </div>
    </div>
    <div id="tuya-advanced-tab" style="display:none">
      <div class="form-row">
        <label for="node-input-ip"><i class="fa fa-tag"></i> IP address</label>
        <a id="node-input-ip" href="" target="_blank"></a>
      </div>
    </div>
    <div id="tuya-mqtt-tab" style="display:none">
      <div class="form-row">
        <label for="node-input-fullTopic"><i class="fa fa-wrench"></i> Full topic</label>
        <input type="text" id="node-input-fullTopic" placeholder="Full topic (Default: %prefix%/%topic%/)">
      </div>
      <div class="form-row">
        <label for="node-input-cmndPrefix"><i class="fa fa-comment"></i> cmnd</label>
        <input type="text" id="node-input-cmndPrefix" placeholder="Command topic prefix (Default: cmnd)">
      </div>
      <div class="form-row">
        <label for="node-input-statPrefix"><i class="fa fa-comment"></i> stat</label>
        <input type="text" id="node-input-statPrefix" placeholder="Stat topic prefix (Default: stat)">
      </div>
      <div class="form-row">
        <label for="node-input-telePrefix"><i class="fa fa-comment"></i> tele</label>
        <input type="text" id="node-input-telePrefix" placeholder="Telemetry topic prefix (Default: tele)">
      </div>
    </div>
  </div>
</script>

<script type="text/html" data-help-name="tuya-device">
</script>

<script type="text/javascript">
   RED.nodes.registerType('tuya-device', {
    category: 'tuya',
    defaults: {
      // node specific
      device: { value: '' }, //MQTT topic
      name: { value: '' },
      // Advanced
      ip: { value: '' },
      // Mqtt
      fullTopic: { value: '' },
      cmndPrefix: { value: '' },
      statPrefix: { value: '' },
      telePrefix: { value: '' },
    },
    label: function() {
      return this.name || this.device || 'Tuya Devce'
    },
    oneditprepare: function () {
      const tabs = RED.tabs.create({
        id: 'node-input-tuya-tabs',
        onchange: function (tab) {
          $('#node-input-tabs-content').children().hide()
          $('#' + tab.id).show()
        }
      })
      tabs.addTab({ id: 'tuya-settings-tab', label: 'Settings' })
      tabs.addTab({ id: 'tuya-advanced-tab', label: 'Advanced' })
      tabs.addTab({ id: 'tuya-mqtt-tab', label: 'MQTT' })
    }
  })
</script>
